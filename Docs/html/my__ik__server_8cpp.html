<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ROS components Documentation: src/my_ik_server.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ROS components Documentation
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">ROS package for my master thesis in robotics engineering, containing the controllers to move TIAGo robot.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">my_ik_server.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Inverse Kinematics solver.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;ros/ros.h&gt;</code><br />
<code>#include &lt;tf/transform_broadcaster.h&gt;</code><br />
<code>#include &lt;string&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &lt;map&gt;</code><br />
<code>#include &lt;geometry_msgs/PoseStamped.h&gt;</code><br />
<code>#include &lt;sensor_msgs/JointState.h&gt;</code><br />
<code>#include &lt;kdl/chain.hpp&gt;</code><br />
<code>#include &lt;urdf/model.h&gt;</code><br />
<code>#include &lt;kdl_parser/kdl_parser.hpp&gt;</code><br />
<code>#include &lt;kdl/tree.hpp&gt;</code><br />
<code>#include &lt;kdl/frames.hpp&gt;</code><br />
<code>#include &lt;kdl/chainiksolverpos_nr_jl.hpp&gt;</code><br />
<code>#include &lt;kdl/chainiksolvervel_pinv.hpp&gt;</code><br />
<code>#include &lt;kdl/chainfksolverpos_recursive.hpp&gt;</code><br />
<code>#include &lt;my_thesis_pkg/MyInverseKinematic.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for my_ik_server.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="my__ik__server_8cpp__incl.png" border="0" usemap="#src_2my__ik__server_8cpp" alt=""/></div>
<map name="src_2my__ik__server_8cpp" id="src_2my__ik__server_8cpp">
<area shape="rect" title="Inverse Kinematics solver." alt="" coords="1081,5,1241,32"/>
<area shape="rect" title=" " alt="" coords="5,87,84,114"/>
<area shape="rect" title=" " alt="" coords="108,87,304,114"/>
<area shape="rect" title=" " alt="" coords="329,87,387,114"/>
<area shape="rect" title=" " alt="" coords="412,87,475,114"/>
<area shape="rect" title=" " alt="" coords="499,87,550,114"/>
<area shape="rect" title=" " alt="" coords="574,87,806,114"/>
<area shape="rect" title=" " alt="" coords="830,87,1017,114"/>
<area shape="rect" title=" " alt="" coords="1041,87,1150,114"/>
<area shape="rect" title=" " alt="" coords="1175,87,1280,114"/>
<area shape="rect" title=" " alt="" coords="1304,87,1495,114"/>
<area shape="rect" title=" " alt="" coords="1519,87,1619,114"/>
<area shape="rect" title=" " alt="" coords="1643,87,1763,114"/>
<area shape="rect" title=" " alt="" coords="1788,80,1944,121"/>
<area shape="rect" title=" " alt="" coords="1968,80,2121,121"/>
<area shape="rect" title=" " alt="" coords="2146,80,2303,121"/>
<area shape="rect" title=" " alt="" coords="2328,87,2599,114"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac2e42f203d0cb05227a453f88415d8ac"><td class="memItemLeft" align="right" valign="top"><a id="ac2e42f203d0cb05227a453f88415d8ac"></a>
KDL::JntArray&#160;</td><td class="memItemRight" valign="bottom"><b>left_joint_limits_min</b> (number_of_joints)</td></tr>
<tr class="separator:ac2e42f203d0cb05227a453f88415d8ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43e9e0bd0b449e7c664ff1ad218dde99"><td class="memItemLeft" align="right" valign="top"><a id="a43e9e0bd0b449e7c664ff1ad218dde99"></a>
KDL::JntArray&#160;</td><td class="memItemRight" valign="bottom"><b>left_joint_limits_max</b> (number_of_joints)</td></tr>
<tr class="separator:a43e9e0bd0b449e7c664ff1ad218dde99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca706d1d71fd34574f34169e788a75d1"><td class="memItemLeft" align="right" valign="top"><a id="aca706d1d71fd34574f34169e788a75d1"></a>
KDL::JntArray&#160;</td><td class="memItemRight" valign="bottom"><b>right_joint_limits_min</b> (number_of_joints)</td></tr>
<tr class="separator:aca706d1d71fd34574f34169e788a75d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16040d3f1e301b3377f21290a613d5ba"><td class="memItemLeft" align="right" valign="top"><a id="a16040d3f1e301b3377f21290a613d5ba"></a>
KDL::JntArray&#160;</td><td class="memItemRight" valign="bottom"><b>right_joint_limits_max</b> (number_of_joints)</td></tr>
<tr class="separator:a16040d3f1e301b3377f21290a613d5ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a480c3e0eb4bacca2056a85fd88a3955c"><td class="memItemLeft" align="right" valign="top"><a id="a480c3e0eb4bacca2056a85fd88a3955c"></a>
KDL::JntArray&#160;</td><td class="memItemRight" valign="bottom"><b>left_joint_positions_initial</b> (number_of_joints)</td></tr>
<tr class="separator:a480c3e0eb4bacca2056a85fd88a3955c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad32e107ec7cbb969577e8ca8337f296a"><td class="memItemLeft" align="right" valign="top"><a id="ad32e107ec7cbb969577e8ca8337f296a"></a>
KDL::JntArray&#160;</td><td class="memItemRight" valign="bottom"><b>right_joint_positions_initial</b> (number_of_joints)</td></tr>
<tr class="separator:ad32e107ec7cbb969577e8ca8337f296a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6b7a69846afcf5ebdf39587178b73bb"><td class="memItemLeft" align="right" valign="top"><a id="ac6b7a69846afcf5ebdf39587178b73bb"></a>
KDL::JntArray&#160;</td><td class="memItemRight" valign="bottom"><b>left_joint_positions_result</b> (number_of_joints)</td></tr>
<tr class="separator:ac6b7a69846afcf5ebdf39587178b73bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a626345cb783f70ffea621d64f5be369e"><td class="memItemLeft" align="right" valign="top"><a id="a626345cb783f70ffea621d64f5be369e"></a>
KDL::JntArray&#160;</td><td class="memItemRight" valign="bottom"><b>right_joint_positions_result</b> (number_of_joints)</td></tr>
<tr class="separator:a626345cb783f70ffea621d64f5be369e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf193baadf33efc0a0600d5ffb62be76"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="my__ik__server_8cpp.html#abf193baadf33efc0a0600d5ffb62be76">jointStateCallback</a> (const sensor_msgs::JointState::ConstPtr &amp;msg)</td></tr>
<tr class="memdesc:abf193baadf33efc0a0600d5ffb62be76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback for for the myRemapped_cmd_vel topic.  <a href="my__ik__server_8cpp.html#abf193baadf33efc0a0600d5ffb62be76">More...</a><br /></td></tr>
<tr class="separator:abf193baadf33efc0a0600d5ffb62be76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cab2ce9cdcddb98d90e0ae1f77f2728"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="my__ik__server_8cpp.html#a4cab2ce9cdcddb98d90e0ae1f77f2728">IKSolver</a> (my_thesis_pkg::MyInverseKinematic::Request &amp;req, my_thesis_pkg::MyInverseKinematic::Response &amp;res)</td></tr>
<tr class="memdesc:a4cab2ce9cdcddb98d90e0ae1f77f2728"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback of the service /my_ik_solver_service <br  />
  <a href="my__ik__server_8cpp.html#a4cab2ce9cdcddb98d90e0ae1f77f2728">More...</a><br /></td></tr>
<tr class="separator:a4cab2ce9cdcddb98d90e0ae1f77f2728"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="my__ik__server_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (int argc, char **argv)</td></tr>
<tr class="memdesc:a3c04138a5bfe5d72780bb7e82a18e627"><td class="mdescLeft">&#160;</td><td class="mdescRight">main function  <a href="my__ik__server_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">More...</a><br /></td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a33b9c04d4eda8b0f596ab32e221d8c86"><td class="memItemLeft" align="right" valign="top"><a id="a33b9c04d4eda8b0f596ab32e221d8c86"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="my__ik__server_8cpp.html#a33b9c04d4eda8b0f596ab32e221d8c86">base_link</a> = &quot;torso_lift_link&quot;</td></tr>
<tr class="memdesc:a33b9c04d4eda8b0f596ab32e221d8c86"><td class="mdescLeft">&#160;</td><td class="mdescRight">chain's base link definition <br /></td></tr>
<tr class="separator:a33b9c04d4eda8b0f596ab32e221d8c86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43ac2c249b6c137af6ab489a2f982ad6"><td class="memItemLeft" align="right" valign="top"><a id="a43ac2c249b6c137af6ab489a2f982ad6"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="my__ik__server_8cpp.html#a43ac2c249b6c137af6ab489a2f982ad6">left_end_link</a> = &quot;arm_left_tool_link&quot;</td></tr>
<tr class="memdesc:a43ac2c249b6c137af6ab489a2f982ad6"><td class="mdescLeft">&#160;</td><td class="mdescRight">left chain's end link definition <br /></td></tr>
<tr class="separator:a43ac2c249b6c137af6ab489a2f982ad6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9150835a660c743a3254c1e8cc897144"><td class="memItemLeft" align="right" valign="top"><a id="a9150835a660c743a3254c1e8cc897144"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="my__ik__server_8cpp.html#a9150835a660c743a3254c1e8cc897144">right_end_link</a> = &quot;arm_right_tool_link&quot;</td></tr>
<tr class="memdesc:a9150835a660c743a3254c1e8cc897144"><td class="mdescLeft">&#160;</td><td class="mdescRight">right chain's end link definition <br /></td></tr>
<tr class="separator:a9150835a660c743a3254c1e8cc897144"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84665e85155b21e6026cedd7841ad980"><td class="memItemLeft" align="right" valign="top"><a id="a84665e85155b21e6026cedd7841ad980"></a>
KDL::Chain&#160;</td><td class="memItemRight" valign="bottom"><b>left_kdl_chain</b></td></tr>
<tr class="separator:a84665e85155b21e6026cedd7841ad980"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1eac1c4128beb890b0192c2d84c47fc"><td class="memItemLeft" align="right" valign="top"><a id="aa1eac1c4128beb890b0192c2d84c47fc"></a>
KDL::Chain&#160;</td><td class="memItemRight" valign="bottom"><b>right_kdl_chain</b></td></tr>
<tr class="separator:aa1eac1c4128beb890b0192c2d84c47fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a239b059060fcac98002e04db84d5363b"><td class="memItemLeft" align="right" valign="top"><a id="a239b059060fcac98002e04db84d5363b"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>number_of_joints</b> = 7</td></tr>
<tr class="separator:a239b059060fcac98002e04db84d5363b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0db8af7f0e314906d2c398b632abe84"><td class="memItemLeft" align="right" valign="top"><a id="aa0db8af7f0e314906d2c398b632abe84"></a>
KDL::Frame&#160;</td><td class="memItemRight" valign="bottom"><b>right_end_effector_desired</b></td></tr>
<tr class="separator:aa0db8af7f0e314906d2c398b632abe84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aded90e02345a97149d25221da7e5788f"><td class="memItemLeft" align="right" valign="top"><a id="aded90e02345a97149d25221da7e5788f"></a>
KDL::Frame&#160;</td><td class="memItemRight" valign="bottom"><b>left_end_effector_desired</b></td></tr>
<tr class="separator:aded90e02345a97149d25221da7e5788f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Inverse Kinematics solver. </p>
<dl class="section author"><dt>Author</dt><dd>Claudio Del Gaizo </dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>7/12/2023</dd></dl>
<p>Subscribes to: <br  />
</p>
<p>/joint_states : to have info about TIAGo's current arms configuration</p>
<p>Service server to: <br  />
</p>
<p>/my_ik_solver_service : to receive request about Inverse kinematics computations</p>
<p>Description:</p>
<p>This simple node implements the server for the service "/my_ik_solver_service", receving request to compute the inverse kinematic. Given a frame position of the end effector return TIAGo's arm configuration required to reach, Subscribes to /joint_states to have info about TIAGo's current arms configuration useful for its computations. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a4cab2ce9cdcddb98d90e0ae1f77f2728"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cab2ce9cdcddb98d90e0ae1f77f2728">&#9670;&nbsp;</a></span>IKSolver()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IKSolver </td>
          <td>(</td>
          <td class="paramtype">my_thesis_pkg::MyInverseKinematic::Request &amp;&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">my_thesis_pkg::MyInverseKinematic::Response &amp;&#160;</td>
          <td class="paramname"><em>res</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback of the service /my_ik_solver_service <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">req</td><td>: my_thesis_pkg::MyInverseKinematic::Request : contains a 6D desired Pose of the end effector</td></tr>
    <tr><td class="paramname">resp</td><td>: :my_thesis_pkg::MyInverseKinematic::Response : contains the correpsondent arm's joints configuration to place the end effector in the desired pose</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool</dd></dl>
<p>This function is executed each time a new request is received. Takes the request Pose and computes the inverse kinematics on TIAGo's geometry using Newton Raphson method, sendind as response the correpsondent arm's joints configuration to place the end effector in the desired pose. </p>

</div>
</div>
<a id="abf193baadf33efc0a0600d5ffb62be76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf193baadf33efc0a0600d5ffb62be76">&#9670;&nbsp;</a></span>jointStateCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void jointStateCallback </td>
          <td>(</td>
          <td class="paramtype">const sensor_msgs::JointState::ConstPtr &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback for for the myRemapped_cmd_vel topic. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>: sensor_msgs::JointState::ConstPtr : the pointer to the joint state data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void</dd></dl>
<p>Callback function to update current joint states information </p>

</div>
</div>
<a id="a3c04138a5bfe5d72780bb7e82a18e627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c04138a5bfe5d72780bb7e82a18e627">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>main function </p>
<p>Entry point. Initializes the node, the subscriber to /joint_states and the service server to /my_ik_solver_service. Then it initializes useful variablee for the IK computation and waits for the service to be called. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
